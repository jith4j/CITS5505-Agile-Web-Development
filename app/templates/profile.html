{% extends "navbar.html" %}
{% block content %}
<div class="container">
    <div class="content-wrap">
        <div class="profile-container">
            <section class="profile-top-container">
                <div class="profile">
                    <div class="profile-pic">
                        <img src="{{ user.avatar(36) }}" alt="Avatar" class="avatar">
                    </div>
                    <div class="profile-details">
                        <div class="username">{{ user.username }}</div>
                        <div class="email">{{ user.email }}</div>
                        <!-- Placeholder for masked password -->
                        <div class="password">***********</div> 
                    </div>
                </div>
            </section>
        <!-- https://codepen.io/Lewitje/pen/doJRBX/ -->
            <div class="profile-body">
                <ul class="profile-tabs" id="ques_ans_list">
                    <li data-tab="questions" class="tab" data-id="{{ user.id }}">My Questions</li>
                    <li data-tab="answers" class="tab" data-id="{{ user.id }}">My Answers</li>
                </ul>
                <div class="profile-tabs-content" id="content">
                    <p>Questions/Answers</p>
                </div>
            </div>
        </div>
    </div>
</div>
    <script>
        $(document).ready(function() {
            $('#ques_ans_list').on('click', '.tab', function() {
                var uid = $(this).data('id')
                $('.tab').removeClass('active'); // Remove 'active' class from all tabs
                $(this).addClass('active'); // Add 'active' class to clicked tab
                var type = $(this).data('tab'); // Get data type (questions or answers)
                var container = $('#content'); 
                container.empty();
                if (type === 'questions') {
                    get_u_questions(uid, container);
                } else {
                    get_u_answers(uid, container);
                }
            });
        });
    
        function get_u_questions(uid, container) {
            $.ajax({
                url: '/uQuestions/' + uid,
                type: 'GET',
                success: function(data) {
                    if (data.length > 0) {
                        var allQuestions = data.map(a => `<li><strong style="color: grey;">${a.time}:</strong> ${a.question}</li>`).join('');
                        container.html(allQuestions);
                    } else {
                        container.html('<p>No questions found.</p>');
                    }
                },
                error: function() {
                    container.html('<p>Error retrieving questions. Please try again.</p>');
                }
            });
        }
    
        function get_u_answers(uid, container) {
            $.ajax({
                url: '/uAnswers/' + uid,
                type: 'GET',
                success: function(data) {
                    if (data.length > 0) {
                        var allAnswers = data.map(a => `<li><strong style="color: grey;">${a.time}:</strong> ${a.answer}</li>`).join('');
                        container.html(allAnswers);
                    } else {
                        container.html('<p>No answers found.</p>');
                    }
                },
                error: function() {
                    container.html('<p>Error retrieving answers. Please try again.</p>');
                }
            });
        }
    </script>
    
    {% endblock %}>